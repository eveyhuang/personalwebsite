---
import PageLayout from "@/layouts/Base";
import { getUniqueTagsWithCount } from "@/utils";
import { getCollection } from "astro:content";

const allPosts = await getCollection("post", ({ data }) => !data.draft);
const allTags = getUniqueTagsWithCount(allPosts);

const meta = {
	title: "All Tags",
	description: "Browse all blog tags",
};
---

<PageLayout meta={meta}>
	<section>
		<div class="section-head">
			<h1>Tags</h1>
			<p class="section-label">All categories</p>
		</div>
		<ul class="grid gap-3 sm:grid-cols-2 lg:grid-cols-3">
			{
				Object.entries(allTags).map(([tag, val]) => (
					<li>
						<a
							class="surface-card block"
							href={`/tags/${tag}`}
							title={`View posts with the tag: ${tag}`}
							rel="prefetch"
						>
							<p class="meta-text">Tag</p>
							<h2 class="mt-2 text-lg font-medium text-accent-2">#{tag}</h2>
							<p class="mt-2 text-sm text-muted">
								{val} Post{val > 1 && "s"}
							</p>
						</a>
					</li>
				))
			}
		</ul>
	</section>
</PageLayout>
